#include "filter_fir.h"


// FIR 滤波器系数数组（从 MATLAB 中导出的）
const float fir_coeffs[NUM_TAPS] = {0.00944195433647714,0.00739601136922350,0.0100139166656085,0.0130171675058081,0.0163557595867400,0.0199682309864266,0.0237852491498935,0.0277138634157171,0.0316474943102324,0.0354798923002040,0.0391003956870132,0.0423923591967715,0.0452472251285642,0.0475744496480585,0.0492986930019602,0.0503593125465859,0.0507172255469571,0.0503593125465859,0.0492986930019602,0.0475744496480585,0.0452472251285642,0.0423923591967715,0.0391003956870132,0.0354798923002040,0.0316474943102324,0.0277138634157171,0.0237852491498935,0.0199682309864266,0.0163557595867400,0.0130171675058081,0.0100139166656085,0.00739601136922350,0.00944195433647714};

// FIR 滤波器状态数组
float fir_state[NUM_TAPS] = {0};

// FIR 滤波器函数
float fir_filter(float input) {
    float output = 0;
    int i;

    // 将输入值存储到状态数组中
    for (i = NUM_TAPS - 1; i > 0; i--) {
        fir_state[i] = fir_state[i - 1];
    }
    fir_state[0] = input;

    // 计算输出值
    for (i = 0; i < NUM_TAPS; i++) {
        output += fir_coeffs[i] * fir_state[i];
    }

    return output;
}

//Example
//int main() {
//    // TODO: 读取输入信号，可以从文件中读取，或者生成一个测试信号
//    // ...

//    // 对输入信号进行滤波并输出结果
//    // for (每个输入信号) {
//    //     float filtered_value = fir_filter(input_value);
//    //     printf("%f\n", filtered_value);
//    // }

//    return 0;
//}
